/* tokens */
:root,
:root[data-theme="dark"],
:root[data-theme="light"] {
    /* mode */
    --ot-hard-reset: 0; /* 0 = respect Mintlify theme, 1 = force bg recolor */

    /* switches */
    --ot-kill-haze: 0; /* 1 ~ remove html/body haze overlays */
    --ot-kill-blur: 0; /* 1 ~ disable backdrop blur strips */
    --ot-kill-sidebar-tint: 0; /* 1 ~ remove sidebar/mobile tint layers */
    --ot-kill-mobile-overlay: 0; /* 1 ~ make mobile overlay transparent */
    --ot-card-invert-hover: 1; /* 0 ~ neutral hover, 1 ~ invert hover */

    /* shapes */
    --ot-radius-sm: 10px;
    --ot-radius-md: 12px;
    --ot-radius-lg: 16px;

    /* effects */
    --ot-link-opacity: 0.9;
    --ot-disabled-opacity: 0.55;
    --ot-focus-outline-width: 2px;
    --ot-focus-outline-offset: 2px;

    /* palette */
    --ot-bg: transparent; /* only used when hard reset = 1 */
    --ot-fg: currentColor; /* lets theme decide */

    --ot-surface: color-mix(in srgb, currentColor 6%, transparent);
    --ot-surface-2: color-mix(in srgb, currentColor 10%, transparent);
    --ot-border: color-mix(in srgb, currentColor 18%, transparent);
    --ot-muted: color-mix(in srgb, currentColor 72%, transparent);
    --ot-muted-2: color-mix(in srgb, currentColor 55%, transparent);
    --ot-code-bg: color-mix(in srgb, currentColor 5%, transparent);

    /* prose tokens Mintlify relies on */
    --tw-prose-body: var(--ot-muted) !important;
    --tw-prose-headings: currentColor !important;
    --tw-prose-lead: var(--ot-muted) !important;
    --tw-prose-links: currentColor !important;
    --tw-prose-bold: currentColor !important;
    --tw-prose-counters: var(--ot-muted-2) !important;
    --tw-prose-bullets: var(--ot-muted-2) !important;
    --tw-prose-hr: var(--ot-border) !important;
    --tw-prose-quotes: currentColor !important;
    --tw-prose-quote-borders: var(--ot-border) !important;
    --tw-prose-captions: var(--ot-muted-2) !important;
    --tw-prose-code: currentColor !important;
    --tw-prose-pre-code: currentColor !important;
    --tw-prose-pre-bg: var(--ot-code-bg) !important;
    --tw-prose-th-borders: var(--ot-border) !important;
    --tw-prose-td-borders: var(--ot-border) !important;

    /* shiki base */
    --shiki-color-text: currentColor !important;
    --shiki-color-background: var(--ot-code-bg) !important;

    /* optional font */
    /* --font-sans: ui-sans-serif, system-ui, -apple-system, "Helvetica Neue", Helvetica, Arial, sans-serif; */

    /* default-to-theme overrides */
    --ot-font-family: revert;
    --ot-body-color: revert;
    --ot-heading-color: revert;
    --ot-link-color: revert;

    --ot-btn-bg: revert;
    --ot-btn-color: revert;
    --ot-btn-border: revert;
    --ot-btn-radius: revert;
    --ot-btn-shadow: revert;

    --ot-input-bg: revert;
    --ot-input-color: revert;
    --ot-input-border: revert;
    --ot-input-radius: revert;
    --ot-input-shadow: revert;

    --ot-code-block-bg: revert;
    --ot-code-block-border: revert;
    --ot-code-block-radius: revert;
    --ot-code-block-shadow: revert;

    --ot-inline-code-bg: revert;
    --ot-inline-code-color: revert;
    --ot-inline-code-radius: revert;

    --ot-card-bg: revert;
    --ot-card-border: revert;
    --ot-card-radius: revert;
    --ot-card-shadow: revert;

    --ot-sidebar-filter: revert;
    --ot-sidebar-opacity: revert;

    --ot-mobile-overlay-bg: revert;
    --ot-mobile-overlay-opacity: revert;
}

/* internal toggles */
@supports selector(:root) {
    :root {
        --_ot-on: calc(var(--ot-hard-reset) * 1);
        --_ot-kill-haze: calc(var(--ot-kill-haze) * 1);
        --_ot-kill-blur: calc(var(--ot-kill-blur) * 1);
        --_ot-kill-sidebar: calc(var(--ot-kill-sidebar-tint) * 1);
        --_ot-kill-mobile-overlay: calc(var(--ot-kill-mobile-overlay) * 1);
        --_ot-card-invert: calc(var(--ot-card-invert-hover) * 1);
    }
}

/* base */
:where(html, body) {
    font-family: var(--ot-font-family);
    color: var(--ot-body-color);
}

/* typography */
:where(#mdx-content, .mdx-content, p, li, span, small, td, th) {
    color: var(--ot-body-color);
}
:where(h1, h2, h3, h4, h5, h6, #page-title, strong, b) {
    color: var(--ot-heading-color);
}

/* links */
:where(a, .link, .navbar-link) {
    color: var(--ot-link-color);
    opacity: var(--ot-link-opacity);
    text-decoration-color: color-mix(in srgb, currentColor 35%, transparent);
}
:where(a:hover, .link:hover, .navbar-link:hover) {
    opacity: 1;
}

/* controls */
:where(button, [role="button"], input[type="button"], input[type="submit"]) {
    background: var(--ot-btn-bg);
    color: var(--ot-btn-color);
    border: var(--ot-btn-border);
    border-radius: var(--ot-btn-radius);
    box-shadow: var(--ot-btn-shadow);
}
:where(button:disabled, [aria-disabled="true"]) {
    opacity: var(--ot-disabled-opacity);
}
:where(input, textarea, select) {
    background: var(--ot-input-bg);
    color: var(--ot-input-color);
    border: var(--ot-input-border);
    border-radius: var(--ot-input-radius);
    box-shadow: var(--ot-input-shadow);
}
:where(input::placeholder, textarea::placeholder) {
    color: var(--ot-muted-2);
}
:where(:focus-visible) {
    outline: var(--ot-focus-outline-width) solid
        color-mix(in srgb, currentColor 35%, transparent);
    outline-offset: var(--ot-focus-outline-offset);
}

/* code */
:where(pre, .code-block, .code-group, .shiki, .shiki pre) {
    background: var(--ot-code-block-bg);
    border: var(--ot-code-block-border);
    border-radius: var(--ot-code-block-radius);
    box-shadow: var(--ot-code-block-shadow);
}
:where(pre code, code) {
    background: transparent;
}
:where(:not(pre) > code) {
    background: var(--ot-inline-code-bg);
    color: var(--ot-inline-code-color);
    border-radius: var(--ot-inline-code-radius);
    padding: 0.15em 0.35em;
}
:where(.code-block button, pre button, #page-context-menu-button) {
    background: transparent;
    border: none;
    box-shadow: none;
}

/* tables */
:where(table) {
    background: transparent;
}

/* cards */
:where(
    a[data-component-part*="card"],
    a:has([data-component-part="card-content-container"])
) {
    background: var(--ot-card-bg);
    border: var(--ot-card-border);
    border-radius: var(--ot-card-radius);
    box-shadow: var(--ot-card-shadow);
    color: currentColor;
}
:where(
    a[data-component-part*="card"]:hover,
    a:has([data-component-part="card-content-container"]):hover
) {
    background: color-mix(
        in srgb,
        var(--ot-surface-2) calc((1 - var(--_ot-card-invert)) * 100%),
        currentColor calc(var(--_ot-card-invert) * 100%)
    );
    color: color-mix(
        in srgb,
        currentColor calc((1 - var(--_ot-card-invert)) * 100%),
        var(--ot-bg) calc(var(--_ot-card-invert) * 100%)
    );
}

/* hard reset background */
:where(
    #header,
    #navbar,
    #navbar-transition,
    #sidebar,
    #sidebar-content,
    #navigation-items,
    #content-container,
    #content-area,
    #content-side-layout,
    #table-of-contents,
    #table-of-contents-layout,
    #table-of-contents-content,
    #footer,
    #panel,
    #body-content
) {
    background: color-mix(
        in srgb,
        var(--ot-bg) calc(var(--_ot-on) * 100%),
        transparent
    );
}

/* haze removal */
:where(html, body)::before,
:where(html, body)::after {
    content: revert;
    background: revert;
    background-image: revert;
    box-shadow: revert;
    filter: revert;
    opacity: calc(1 - var(--_ot-kill-haze));
}
:where(html, body):where(:has(body))::before,
:where(html, body):where(:has(body))::after {
    opacity: calc(1 - var(--_ot-kill-haze));
}

/* blur strips */
:where(#header, #navbar, #navbar-transition) {
    backdrop-filter: revert;
    -webkit-backdrop-filter: revert;
}
:where(#header, #navbar, #navbar-transition):where(*) {
    backdrop-filter: blur(calc((1 - var(--_ot-kill-blur)) * 10px));
    -webkit-backdrop-filter: blur(calc((1 - var(--_ot-kill-blur)) * 10px));
}

/* sidebar tint */
:where(
    #sidebar,
    #sidebar-content,
    #navigation-items,
    nav[role="navigation"],
    aside[role="navigation"],
    #mobile-nav,
    [id^="headlessui-dialog-panel"]
) {
    filter: var(--ot-sidebar-filter);
    opacity: var(--ot-sidebar-opacity);
}
:where(
    #sidebar [class*="bg-gradient"],
    #sidebar [class*="from-"],
    #sidebar [class*="via-"],
    #sidebar [class*="to-"],
    #sidebar [class*="backdrop-blur"],
    #mobile-nav [class*="bg-gradient"],
    #mobile-nav [class*="from-"],
    #mobile-nav [class*="via-"],
    #mobile-nav [class*="to-"],
    #mobile-nav [class*="backdrop-blur"]
) {
    background: color-mix(
        in srgb,
        transparent calc(var(--_ot-kill-sidebar) * 100%),
        revert
    );
    background-image: none;
    box-shadow: none;
}

/* mobile overlay */
:where([id^="headlessui-dialog"] > .fixed.inset-0) {
    background: var(--ot-mobile-overlay-bg);
    opacity: var(--ot-mobile-overlay-opacity);
    backdrop-filter: none;
    -webkit-backdrop-filter: none;
}
:where([id^="headlessui-dialog"] > .fixed.inset-0) {
    opacity: calc(1 - var(--_ot-kill-mobile-overlay));
}

/* sidebar current page */
:where(
    #sidebar a[aria-current="page"],
    #sidebar a[aria-selected="true"],
    .sidebar a[aria-current="page"],
    .sidebar a[aria-selected="true"]
) {
    background: var(--ot-surface-2);
    border-radius: var(--ot-radius-sm);
}
